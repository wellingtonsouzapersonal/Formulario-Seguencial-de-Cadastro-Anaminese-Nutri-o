<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Cadastro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .form-container {
            background-color: #ffffff;
            padding: 32px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            max-width: 700px;
            width: 100%;
            border: 1px solid #e0e0e0;
            position: relative;
            z-index: 1;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        input[type="text"],
        input[type="email"],
        input[type="date"],
        input[type="tel"],
        input[type="number"],
        input[type="time"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 16px;
            color: #555;
            transition: border-color 0.3s ease;
        }
        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="date"]:focus,
        input[type="tel"]:focus,
        input[type="number"]:focus,
        input[type="time"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }
        .radio-group label, .checkbox-group label {
            display: inline-flex;
            align-items: center;
            margin-right: 20px;
            cursor: pointer;
            font-weight: 400;
        }
        .radio-group input[type="radio"], .checkbox-group input[type="checkbox"] {
            margin-right: 8px;
            transform: scale(1.2);
        }
        button {
            width: 100%;
            padding: 16px;
            background-color: #6366f1;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            margin-top: 10px;
        }
        button:hover {
            background-color: #4f46e5;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25);
        }
        .button-highlight {
            background-color: #10B981;
        }
        .button-highlight:hover {
            background-color: #059669;
        }
        .price-display {
            background-color: #e0f2fe;
            color: #0c4a6e;
            padding: 16px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
            font-weight: 600;
            font-size: 1.25rem;
            border: 1px solid #90cdf4;
        }
        .plan-details {
            background-color: #f0fdf4;
            color: #166534;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            border: 1px solid #a7f3d0;
            font-size: 0.9rem;
        }
        .plan-details ul {
            list-style: disc;
            margin-left: 20px;
        }
        .plan-details li {
            margin-bottom: 4px;
        }
        .logo {
            display: block;
            margin: 0 auto 20px auto;
            max-width: 150px;
            height: auto;
        }
        .age-display {
            margin-left: 10px;
            font-weight: 500;
            color: #555;
        }
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #4f46e5;
            margin-top: 30px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }
        .hidden-group {
            display: none;
        }
        .observation-text {
            font-size: 0.9rem;
            color: #6b7280;
            margin-top: 10px;
            font-style: italic;
            text-align: center;
        }
        .motivational-phrase {
            font-style: italic;
            font-weight: 500;
            text-align: center;
            margin-top: 30px;
            margin-bottom: 20px;
            color: #4a5568;
            font-size: 1rem;
        }
        .meal-details {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            margin-left: 30px;
        }
        .welcome-message {
            background-color: #d1fae5;
            color: #065f46;
            padding: 16px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1rem;
            display: none;
        }
        .review-data p {
            margin-bottom: 8px;
            font-size: 1rem;
            color: #4a5568;
        }
        .review-data strong {
            color: #2d3748;
        }
        /* Estilo para a mensagem de erro de validação */
        .error-message {
            color: #ef4444; /* red-500 */
            font-size: 0.875rem; /* text-sm */
            margin-top: -10px;
            margin-bottom: 10px;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <img src="https://raw.githubusercontent.com/wellingtonsouzapersonal/Formul-rio-de-Anaminese/main/WS%20LOGO%20MARCADA%CC%81GUA.png" alt="Logomarca" class="logo" onerror="this.onerror=null; this.src='https://placehold.co/150x50/cccccc/333333?text=Logo+Não+Encontrada';">
        <form id="multiStepForm" action="https://formspree.io/f/meozeakg" method="POST" class="space-y-6">

            <div id="step1">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Formulário de Cadastro</h2>
                <div class="section-title">Informações Pessoais</div>

                <div class="form-group">
                    <label for="nomeCompleto">Nome completo:</label>
                    <input type="text" id="nomeCompleto" name="Nome Completo" required class="rounded-lg">
                </div>

                <div class="form-group">
                    <label for="dataNascimento">Data de Nascimento:</label>
                    <div class="flex items-center">
                        <input type="date" id="dataNascimento" name="Data de Nascimento" required class="rounded-lg flex-grow">
                        <span id="idadeDisplay" class="age-display"></span>
                        <input type="hidden" id="idadeHidden" name="Idade">
                    </div>
                </div>

                <div class="form-group flex flex-col sm:flex-row sm:space-x-4">
                    <div class="w-full sm:w-1/2 mb-4 sm:mb-0">
                        <label for="altura">Altura (cm):</label>
                        <input type="number" id="altura" name="Altura" min="50" max="300" placeholder="Ex: 175" required class="rounded-lg">
                    </div>
                    <div class="w-full sm:w-1/2">
                        <label for="peso">Peso (kg):</label>
                        <input type="number" id="peso" name="Peso" min="1" max="500" step="0.1" placeholder="Ex: 70.5" required class="rounded-lg">
                    </div>
                </div>

                <div class="form-group flex flex-col sm:flex-row sm:space-x-4">
                    <div class="w-full sm:w-1/2 mb-4 sm:mb-0">
                        <label>Gênero:</label>
                        <div class="radio-group flex mt-2">
                            <label><input type="radio" name="Genero" value="Feminino" required> Feminino</label>
                            <label><input type="radio" name="Genero" value="Masculino"> Masculino</label>
                        </div>
                    </div>
                    <div class="w-full sm:w-1/2">
                        <label for="profissao">Profissão:</label>
                        <input type="text" id="profissao" name="Profissão" required class="rounded-lg">
                    </div>
                </div>

                <div class="form-group">
                    <label for="telefoneContato">Telefone de contato:</label>
                    <input type="tel" id="telefoneContato" name="Telefone de Contato" placeholder="(XX) XXXXX-XXXX" required class="rounded-lg">
                </div>

                <div class="form-group">
                    <label for="contatoEmergencia">Nome e Telefone do Contato de Emergência:</label>
                    <input type="text" id="contatoEmergencia" name="Contato de Emergência" placeholder="Ex: Nome do Contato (XX) XXXXX-XXXX" required class="rounded-lg">
                </div>

                <div class="form-group">
                    <label for="cpf">CPF:</label>
                    <input type="text" id="cpf" name="CPF" required class="rounded-lg">
                </div>

                <div class="form-group">
                    <label for="endereco">Endereço:</label>
                    <input type="text" id="endereco" name="Endereço" required class="rounded-lg">
                </div>

                <div class="form-group">
                    <label for="email">E-mail:</label>
                    <input type="email" id="email" name="E-mail" required class="rounded-lg">
                </div>

                <div class="form-group">
                    <label for="instagram">Instagram:</label>
                    <input type="text" id="instagram" name="Instagram" placeholder="@seu_instagram" required class="rounded-lg">
                </div>

                <div class="form-group">
                    <label for="dataInicio">Data de início:</label>
                    <input type="date" id="dataInicio" name="Data de Início" required class="rounded-lg">
                </div>

                <div class="form-group">
                    <label>Escolha o seu Plano:</label>
                    <div class="radio-group flex flex-wrap gap-4 mt-2">
                        <label>
                            <input type="radio" name="Plano Escolhido" value="Trimestral Individual" required onchange="calculatePrice()">
                            Trimestral Individual
                        </label>
                        <label>
                            <input type="radio" name="Plano Escolhido" value="Semestral Individual" onchange="calculatePrice()">
                            Semestral Individual
                        </label>
                        <label>
                            <input type="radio" name="Plano Escolhido" value="Trimestral Casal" onchange="calculatePrice()">
                            Trimestral Casal
                        </label>
                        <label>
                            <input type="radio" name="Plano Escolhido" value="Semestral Casal" onchange="calculatePrice()">
                            Semestral Casal
                        </label>
                        <label>
                            <input type="radio" name="Plano Escolhido" value="Online" onchange="calculatePrice()">
                            Online
                        </label>
                    </div>
                    <div id="planDetailsDisplay" class="plan-details hidden-group"></div>
                </div>

                <div class="form-group">
                    <label>Deseja incluir planejamento alimentar?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Planejamento Alimentar" value="Sim" required onchange="calculatePrice()"> Sim</label>
                        <label><input type="radio" name="Planejamento Alimentar" value="Não" onchange="calculatePrice()"> Não</label>
                    </div>
                    <p id="planejamentoOnlineWarning" class="error-message hidden-group">⚠️ O plano Online exige a contratação do planejamento alimentar.</p>
                </div>

                <div class="form-group">
                    <label for="frequenciaSemana">Quantas vezes por semana:</label>
                    <select id="frequenciaSemana" name="Frequência Semanal" required class="rounded-lg" onchange="calculatePrice()">
                        <option value="">Selecione uma opção</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="formaPagamento">Forma de pagamento:</label>
                    <select id="formaPagamento" name="Forma de Pagamento" required class="rounded-lg" onchange="calculatePrice()">
                        <option value="">Selecione uma opção</option>
                        <option value="Dinheiro">Dinheiro (0,00%)</option>
                        <option value="Pix">Pix (0,00%)</option>
                        <option value="Débito">Débito (1,99%)</option>
                        <option value="Crédito (à vista)">Crédito (à vista - 4,98%)</option>
                        <option value="Crédito (parcelado até 6x)">Crédito (parcelado até 6x - 6% por parcela)</option>
                        <option value="Boleto">Boleto (acréscimo R$5,00 por boleto)</option>
                    </select>
                </div>

                <div class="form-group">
                    <div id="valorEstimado" class="price-display">
                        Selecione as opções para ver o valor estimado.
                    </div>
                    <input type="hidden" id="valorEstimadoHidden" name="Valor Estimado Mensal">
                </div>

                <p class="motivational-phrase">Mudar não é fácil, mas quando você nota os resultados, nada te faz parar.</p>

                <button type="button" onclick="nextStep(1)" class="button-highlight">Próximo</button>
            </div>

            <div id="step2" class="hidden-group">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Formulário de Anaminese</h2>

                <div class="section-title">Histórico de Aptidão Física</div>

                <div class="form-group">
                    <label>Teve alguma cirurgia nos últimos 12 meses?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Cirurgia Últimos 12 Meses (Anaminese)" value="Sim" required onchange="toggleDetails('cirurgia', this)"> Sim</label>
                        <label><input type="radio" name="Cirurgia Últimos 12 Meses (Anaminese)" value="Não" onchange="toggleDetails('cirurgia', this)"> Não</label>
                    </div>
                    <div id="cirurgiaDetalhes" class="hidden-group">
                        <label for="qualCirurgiaData" class="mt-2">Cirurgia(s) e data:</label>
                        <textarea id="qualCirurgiaData" name="Qual Cirurgia e Data (Anaminese)" rows="2" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>Possui problemas de coluna (hérnia, escoliose, etc.)?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Problemas Coluna (Anaminese)" value="Sim" required onchange="toggleDetails('coluna', this)"> Sim</label>
                        <label><input type="radio" name="Problemas Coluna (Anaminese)" value="Não" onchange="toggleDetails('coluna', this)"> Não</label>
                    </div>
                    <div id="colunaDetalhes" class="hidden-group">
                        <label for="qualProblemaColuna" class="mt-2">Problema(s) e localização:</label>
                        <textarea id="qualProblemaColuna" name="Qual Problema Coluna (Anaminese)" rows="2" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>Possui problemas nas articulações (joelhos, ombros, tornozelos, etc.)?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Problemas Articulações (Anaminese)" value="Sim" required onchange="toggleDetails('articulacoes', this)"> Sim</label>
                        <label><input type="radio" name="Problemas Articulações (Anaminese)" value="Não" onchange="toggleDetails('articulacoes', this)"> Não</label>
                    </div>
                    <div id="articulacoesDetalhes" class="hidden-group">
                        <label for="qualProblemaArticulacao" class="mt-2">Problema(s), localização e frequência:</label>
                        <textarea id="qualProblemaArticulacao" name="Qual Problema Articulação (Anaminese)" rows="2" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>Já teve alguma lesão muscular ou articular grave?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Lesão Muscular Articular (Anaminese)" value="Sim" required onchange="toggleDetails('lesao', this)"> Sim</label>
                        <label><input type="radio" name="Lesão Muscular Articular (Anaminese)" value="Não" onchange="toggleDetails('lesao', this)"> Não</label>
                    </div>
                    <div id="lesaoDetalhes" class="hidden-group">
                        <label for="qualLesaoTratamento" class="mt-2">Lesão(ões), quando e tratamento:</label>
                        <textarea id="qualLesaoTratamento" name="Qual Lesão e Tratamento (Anaminese)" rows="3" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>Possui alguma restrição médica para exercícios físicos?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Restrição Médica (Anaminese)" value="Sim" required onchange="toggleDetails('restricaoMedica', this)"> Sim</label>
                        <label><input type="radio" name="Restrição Médica (Anaminese)" value="Não" onchange="toggleDetails('restricaoMedica', this)"> Não</label>
                    </div>
                    <div id="restricaoMedicaDetalhes" class="hidden-group">
                        <label for="qualRestricaoMedica" class="mt-2">Restrição:</label>
                        <textarea id="qualRestricaoMedica" name="Qual Restrição Médica (Anaminese)" rows="2" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="section-title">Hábitos de Vida e Treino</div>

                <div class="form-group">
                    <label>Fuma?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Fuma (Anaminese)" value="Sim" required onchange="toggleDetails('fuma', this)"> Sim</label>
                        <label><input type="radio" name="Fuma (Anaminese)" value="Não" onchange="toggleDetails('fuma', this)"> Não</label>
                    </div>
                    <div id="fumaDetalhes" class="hidden-group">
                        <label class="mt-2">Frequência:</label>
                        <div class="radio-group flex mt-2">
                            <label><input type="radio" name="Frequência Fuma (Anaminese)" value="Frequentemente" required> Frequentemente</label>
                            <label><input type="radio" name="Frequência Fuma (Anaminese)" value="Socialmente"> Socialmente</label>
                            <label><input type="radio" name="Frequência Fuma (Anaminese)" value="Raramente"> Raramente</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Ingere bebida alcoólica?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Ingere Álcool (Anaminese)" value="Sim" required onchange="toggleDetails('alcool', this)"> Sim</label>
                        <label><input type="radio" name="Ingere Álcool (Anaminese)" value="Não" onchange="toggleDetails('alcool', this)"> Não</label>
                    </div>
                    <div id="alcoolDetalhes" class="hidden-group">
                        <label class="mt-2">Frequência:</label>
                        <div class="radio-group flex mt-2">
                            <label><input type="radio" name="Frequência Álcool (Anaminese)" value="Frequentemente" required> Frequentemente</label>
                            <label><input type="radio" name="Frequência Álcool (Anaminese)" value="Socialmente"> Socialmente</label>
                            <label><input type="radio" name="Frequência Álcool (Anaminese)" value="Raramente"> Raramente</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Pratica atividade física atualmente?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Pratica Atividade Física (Anaminese)" value="Sim" required onchange="toggleDetails('atividadeFisica', this)"> Sim</label>
                        <label><input type="radio" name="Pratica Atividade Física (Anaminese)" value="Não" onchange="toggleDetails('atividadeFisica', this)"> Não</label>
                    </div>
                    <div id="atividadeFisicaDetalhes" class="hidden-group">
                        <label for="qualAtividadeFrequenciaTempo" class="mt-2">Atividade(s), frequência e há quanto tempo:</label>
                        <textarea id="qualAtividadeFrequenciaTempo" name="Qual Atividade, Frequência e Tempo (Anaminese)" rows="3" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>Qual seu nível de experiência com musculação?</label>
                    <div class="radio-group flex flex-col mt-2 space-y-2">
                        <label><input type="radio" name="Nível Experiência Musculação (Anaminese)" value="Iniciante" required onchange="toggleDetails('experiencia', this)"> Iniciante (nunca treinou ou treinou pouco)</label>
                        <label><input type="radio" name="Nível Experiência Musculação (Anaminese)" value="Intermediário" onchange="toggleDetails('experiencia', this)"> Intermediário (treina há algum tempo, mas sem grande regularidade/intensidade)</label>
                        <label><input type="radio" name="Nível Experiência Musculação (Anaminese)" value="Avançado" onchange="toggleDetails('experiencia', this)"> Avançado (treina há bastante tempo, com regularidade e intensidade)</label>
                    </div>
                    <div id="experienciaDetalhes" class="hidden-group">
                        <label for="tempoTreinou" class="mt-2">Tempo que treinou:</label>
                        <textarea id="tempoTreinou" name="Tempo Treinou (Anaminese)" rows="2" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>Já treinou com personal trainer?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Treinou Personal Trainer (Anaminese)" value="Sim" required> Sim</label>
                        <label><input type="radio" name="Treinou Personal Trainer (Anaminese)" value="Não"> Não</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>Qualidade do sono:</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Qualidade do Sono (Anaminese)" value="Boa" required onchange="toggleDetails('sono', this)"> Boa</label>
                        <label><input type="radio" name="Qualidade do Sono (Anaminese)" value="Regular" onchange="toggleDetails('sono', this)"> Regular</label>
                        <label><input type="radio" name="Qualidade do Sono (Anaminese)" value="Ruim" onchange="toggleDetails('sono', this)"> Ruim</label>
                    </div>
                    <div id="sonoDetalhes" class="hidden-group">
                        <label for="horasSonoNoite">Horas/noite:</label>
                        <input type="number" id="horasSonoNoite" name="Horas de Sono por Noite (Anaminese)" min="0" max="24" class="rounded-lg">
                    </div>
                </div>

                <div class="section-title">Objetivos e Expectativas</div>

                <div class="form-group">
                    <label>Qual seu principal objetivo com a musculação? (Pode marcar mais de um)</label>
                    <div class="checkbox-group flex flex-col mt-2 space-y-2">
                        <label><input type="checkbox" name="Objetivos Musculação (Anaminese)" value="Ganho de Massa Muscular"> Ganho de Massa Muscular (Hipertrofia)</label>
                        <label><input type="checkbox" name="Objetivos Musculação (Anaminese)" value="Emagrecimento / Perda de Gordura"> Emagrecimento / Perda de Gordura</label>
                        <label><input type="checkbox" name="Objetivos Musculação (Anaminese)" value="Melhora da Força"> Melhora da Força</label>
                        <label><input type="checkbox" name="Objetivos Musculação (Anaminese)" value="Melhora da Resistência"> Melhora da Resistência</label>
                        <label><input type="checkbox" name="Objetivos Musculação (Anaminese)" value="Condicionamento Físico Geral"> Condicionamento Físico Geral</label>
                        <label><input type="checkbox" name="Objetivos Musculação (Anaminese)" value="Saúde e Bem-estar"> Saúde e Bem-estar</label>
                        <label><input type="checkbox" name="Objetivos Musculação (Anaminese)" value="Reabilitação / Fortalecimento" id="reabilitacaoCheckbox" onchange="toggleDetails('reabilitacao', this)"> Reabilitação / Fortalecimento</label>
                        <div id="reabilitacaoDetalhes" class="hidden-group">
                            <textarea id="especificarReabilitacao" name="Especificar Reabilitação (Anaminese)" rows="2" class="rounded-lg mt-2" placeholder="Especifique a reabilitação/fortalecimento"></textarea>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="resultadoExpectativa">Qual resultado você espera alcançar e em quanto tempo (aproximadamente)?</label>
                    <textarea id="resultadoExpectativa" name="Resultado e Expectativa (Anaminese)" rows="3" required class="rounded-lg"></textarea>
                </div>

                <div class="form-group">
                    <label for="outrasInformacoes">Há algo mais que você gostaria de nos informar sobre sua saúde ou objetivos?</label>
                    <textarea id="outrasInformacoes" name="Outras Informações (Anaminese)" rows="4" required class="rounded-lg"></textarea>
                </div>

                <p class="motivational-phrase">Seu corpo é capaz de tudo, é sua mente que você precisa convencer.</p>

                <div class="flex justify-between mt-6">
                    <button type="button" onclick="prevStep()" class="w-1/2 mr-2 bg-gray-500 hover:bg-gray-600">Voltar</button>
                    <button type="button" onclick="nextStep(2)" class="button-highlight">Próximo</button>
                </div>
            </div>

            <div id="step3" class="hidden-group">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Formulário Nutricional</h2>
                <div class="section-title">Histórico de Saúde (Nutricional)</div>
                <div class="form-group">
                    <label>Faz uso de alguma medicação contínua?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Medicação Contínua (Nutricional)" value="Sim" required onchange="toggleDetails('medicaoContinuaNutricional', this)"> Sim</label>
                        <label><input type="radio" name="Medicação Contínua (Nutricional)" value="Não" onchange="toggleDetails('medicaoContinuaNutricional', this)"> Não</label>
                    </div>
                    <div id="medicaoContinuaDetalhesNutricional" class="hidden-group">
                        <label for="qualMedicacaoNutricional" class="mt-2">Medicamento(s):</label>
                        <textarea id="qualMedicacaoNutricional" name="Qual Medicação (Nutricional)" rows="2" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>Possui alguma doença crônica (Diabetes, Hipertensão, Cardíacas, Asma, Tireoide, etc.)?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Doença Crônica (Nutricional)" value="Sim" required onchange="toggleDetails('doencaCronicaNutricional', this)"> Sim</label>
                        <label><input type="radio" name="Doença Crônica (Nutricional)" value="Não" onchange="toggleDetails('doencaCronicaNutricional', this)"> Não</label>
                    </div>
                    <div id="doencaCronicaDetalhesNutricional" class="hidden-group">
                        <label for="qualDoencaNutricional" class="mt-2">Qual(is) doença(s):</label>
                        <textarea id="qualDoencaNutricional" name="Qual Doença Crônica (Nutricional)" rows="2" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>Possui intolerância alimentar?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Intolerância Alimentar (Nutricional)" value="Sim" required onchange="toggleDetails('intoleranciaAlimentarNutricional', this)"> Sim</label>
                        <label><input type="radio" name="Intolerância Alimentar (Nutricional)" value="Não" onchange="toggleDetails('intoleranciaAlimentarNutricional', this)"> Não</label>
                    </div>
                    <div id="intoleranciaAlimentarDetalhesNutricional" class="hidden-group">
                        <label for="qualIntoleranciaNutricional" class="mt-2">Qual(is) intolerância(s):</label>
                        <textarea id="qualIntoleranciaNutricional" name="Qual Intolerância Alimentar (Nutricional)" rows="2" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>Faz uso de suplementos alimentares?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Uso de Suplementos (Nutricional)" value="Sim" required onchange="toggleDetails('suplementosNutricional', this)"> Sim</label>
                        <label><input type="radio" name="Uso de Suplementos (Nutricional)" value="Não" onchange="toggleDetails('suplementosNutricional', this)"> Não</label>
                    </div>
                    <div id="suplementosNutricionalDetalhes" class="hidden-group">
                        <label for="quaisSuplementosNutricional" class="mt-2">Qual(is) e frequência:</label>
                        <textarea id="quaisSuplementosNutricional" name="Qual Suplementos (Nutricional)" rows="2" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="section-title">Rotina Alimentar</div>
                <p class="observation-text">Descreva sua rotina alimentar o mais detalhadamente possível. Quanto mais informações, melhor!</p>

                <div class="form-group">
                    <label>Qualidade do sono:</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Qualidade do Sono (Nutricional)" value="Boa" required> Boa</label>
                        <label><input type="radio" name="Qualidade do Sono (Nutricional)" value="Regular"> Regular</label>
                        <label><input type="radio" name="Qualidade do Sono (Nutricional)" value="Ruim"> Ruim</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="acordaHoraNutricional">A que horas geralmente você acorda?</label>
                    <input type="time" id="acordaHoraNutricional" name="Horário que Acorda (Nutricional)" required class="rounded-lg">
                </div>

                <div class="form-group">
                    <label for="dormeHoraNutricional">A que horas geralmente você dorme?</label>
                    <input type="time" id="dormeHoraNutricional" name="Horário que Dorme (Nutricional)" required class="rounded-lg">
                </div>

                <div class="form-group">
                    <label>Sente necessidade de beber café?</label>
                    <div class="radio-group flex mt-2">
                        <label><input type="radio" name="Bebe Café (Nutricional)" value="Sim" required onchange="toggleDetails('cafeNutricional', this)"> Sim</label>
                        <label><input type="radio" name="Bebe Café (Nutricional)" value="Não" onchange="toggleDetails('cafeNutricional', this)"> Não</label>
                    </div>
                    <div id="cafeNutricionalDetalhes" class="hidden-group">
                        <label for="qualCafeNutricional" class="mt-2">Quantidade de xícaras/dia e tipo (com ou sem açúcar):</label>
                        <textarea id="qualCafeNutricional" name="Qual Café (Nutricional)" rows="2" class="rounded-lg"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label for="coposAguaNutricional">Quantos copos de água (200 ml) você bebe por dia?</label>
                    <input type="number" id="coposAguaNutricional" name="Quantidade Água (Nutricional)" min="0" required class="rounded-lg">
                </div>

                <div class="form-group">
                    <label for="ingredientesNaoGostaNutricional">Quais ingredientes/alimentos você não gosta?</label>
                    <textarea id="ingredientesNaoGostaNutricional" name="Ingredientes que Não Gosta (Nutricional)" rows="2" class="rounded-lg"></textarea>
                </div>

                <div class="form-group">
                    <label for="melhorHorarioTreinoNutricional">Qual o melhor horário para treinar?</label>
                    <select id="melhorHorarioTreinoNutricional" name="Melhor Horário para Treino (Nutricional)" required class="rounded-lg">
                        <option value="">Selecione uma opção</option>
                        <option value="Manhã">Manhã (5h - 11h)</option>
                        <option value="Tarde">Tarde (12h - 17h)</option>
                        <option value="Noite">Noite (18h - 22h)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="refeicaoPreTreinoNutricional">O que você come na refeição pré-treino?</label>
                    <textarea id="refeicaoPreTreinoNutricional" name="Refeição Pré-Treino (Nutricional)" rows="2" class="rounded-lg" required></textarea>
                </div>

                <div class="form-group">
                    <label for="refeicaoPosTreinoNutricional">O que você come na refeição pós-treino?</label>
                    <textarea id="refeicaoPosTreinoNutricional" name="Refeição Pós-Treino (Nutricional)" rows="2" class="rounded-lg" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="refeicoesDiaNutricional">Quantas refeições faz por dia?</label>
                    <input type="number" id="refeicoesDiaNutricional" name="Refeições por Dia (Nutricional)" min="1" required class="rounded-lg">
                </div>
                
                <div class="form-group">
                    <label>Descreva em detalhes as suas refeições do dia:</label>
                    <div class="meal-details space-y-4">
                        <div class="form-group">
                            <label for="cafeManha">Café da Manhã:</label>
                            <textarea id="cafeManha" name="Café da Manhã (Nutricional)" rows="2" class="rounded-lg"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="almoco">Almoço:</label>
                            <textarea id="almoco" name="Almoço (Nutricional)" rows="2" class="rounded-lg"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="lancheTarde">Lanche da Tarde:</label>
                            <textarea id="lancheTarde" name="Lanche da Tarde (Nutricional)" rows="2" class="rounded-lg"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="jantar">Jantar:</label>
                            <textarea id="jantar" name="Jantar (Nutricional)" rows="2" class="rounded-lg"></textarea>
                        </div>
                    </div>
                </div>

                <p class="motivational-phrase">O segredo é começar. O segredo é continuar. O segredo é ter paciência. O segredo é o processo.</p>

                <div class="flex justify-between mt-6">
                    <button type="button" onclick="prevStep()" class="w-1/2 mr-2 bg-gray-500 hover:bg-gray-600">Voltar</button>
                    <button type="button" onclick="nextStep(3)" class="button-highlight">Revisar dados</button>
                </div>
            </div>
            
            <div id="step4" class="hidden-group">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Revisar e Enviar</h2>
                <div id="reviewContent" class="review-data space-y-4">
                    </div>
                
                <p class="motivational-phrase">Parabéns por chegar até aqui! Revise suas informações com atenção antes de enviar.</p>

                <div class="flex justify-between mt-6">
                    <button type="button" onclick="prevStep()" class="w-1/2 mr-2 bg-gray-500 hover:bg-gray-600">Voltar</button>
                    <button type="submit" class="button-highlight">Enviar Formulário</button>
                </div>
            </div>
            
            <div id="successMessage" class="welcome-message">
                <p>Formulário enviado com sucesso! Aguarde o contato da nossa equipe. Obrigado por confiar no nosso trabalho! 🤝</p>
            </div>
        </form>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 4;
        const form = document.getElementById('multiStepForm');
        
        // Dados de preços (valores mensais)
        const prices = {
            'Trimestral Individual': 280,
            'Semestral Individual': 250,
            'Trimestral Casal': 450,
            'Semestral Casal': 420,
            'Online': 120
        };

        // Dados de acréscimos de pagamento
        const paymentFees = {
            'Dinheiro': 0,
            'Pix': 0,
            'Débito': 0.0199,
            'Crédito (à vista)': 0.0498,
            'Crédito (parcelado até 6x)': 0.06,
            'Boleto': 5 // Valor fixo
        };

        const planDetails = {
            'Trimestral Individual': '✅ Acompanhamento presencial\n✅ Planilha de treino individualizada\n✅ Avaliação física mensal',
            'Semestral Individual': '✅ Acompanhamento presencial\n✅ Planilha de treino individualizada\n✅ Avaliação física mensal\n🎁 Desconto especial',
            'Trimestral Casal': '✅ Acompanhamento presencial para o casal\n✅ Planilha de treino individualizada\n✅ Avaliação física mensal',
            'Semestral Casal': '✅ Acompanhamento presencial para o casal\n✅ Planilha de treino individualizada\n✅ Avaliação física mensal\n🎁 Desconto especial',
            'Online': '✅ Planilha de treino online\n✅ Acompanhamento a distância\n✅ Avaliação online\n⚠️ Requer planejamento alimentar'
        };

        const steps = [
            document.getElementById('step1'),
            document.getElementById('step2'),
            document.getElementById('step3'),
            document.getElementById('step4')
        ];

        // Adiciona um listener para o evento de submit do formulário para tratar o envio com Formspree
        form.addEventListener('submit', function(event) {
            event.preventDefault(); // Impede o envio padrão do formulário
            const formStatus = document.getElementById('successMessage');
            
            // Simula o envio
            formStatus.style.display = 'block';
            
            // Envia os dados para o Formspree
            const formData = new FormData(form);
            fetch(form.action, {
                method: form.method,
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            }).then(response => {
                if (response.ok) {
                    console.log('Formulário enviado com sucesso!');
                } else {
                    response.json().then(data => {
                        if (Object.hasOwn(data, 'errors')) {
                            alert(data["errors"].map(error => error["message"]).join(", "));
                        } else {
                            alert('Ops! Algo deu errado ao enviar o formulário.');
                        }
                    })
                }
            }).catch(error => {
                alert('Ocorreu um erro na conexão: ' + error);
            });
        });

        // Event listener para calcular a idade ao mudar a data de nascimento
        document.getElementById('dataNascimento').addEventListener('change', function() {
            const birthDate = new Date(this.value);
            if (isNaN(birthDate)) return;

            const today = new Date();
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDifference = today.getMonth() - birthDate.getMonth();
            if (monthDifference < 0 || (monthDifference === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }
            document.getElementById('idadeDisplay').innerText = `(${age} anos)`;
            document.getElementById('idadeHidden').value = age;
        });

        function calculatePrice() {
            const plano = document.querySelector('input[name="Plano Escolhido"]:checked');
            const frequencia = document.getElementById('frequenciaSemana').value;
            const planejamento = document.querySelector('input[name="Planejamento Alimentar"]:checked');
            const formaPagamento = document.getElementById('formaPagamento').value;
            const valorDisplay = document.getElementById('valorEstimado');
            const valorHidden = document.getElementById('valorEstimadoHidden');
            const planDetailsDisplay = document.getElementById('planDetailsDisplay');
            const planejamentoOnlineWarning = document.getElementById('planejamentoOnlineWarning');

            // Resetar o aviso de planejamento online
            planejamentoOnlineWarning.classList.add('hidden-group');
            
            // Mostra os detalhes do plano selecionado
            if (plano) {
                planDetailsDisplay.classList.remove('hidden-group');
                let detailsText = planDetails[plano.value];
                planDetailsDisplay.innerHTML = `<strong>Detalhes do Plano:</strong><br>${detailsText.replace(/\\n/g, '<br>')}`;
                if (plano.value === 'Online' && planejamento?.value === 'Não') {
                    planejamentoOnlineWarning.classList.remove('hidden-group');
                }
            } else {
                planDetailsDisplay.classList.add('hidden-group');
            }

            if (!plano || !frequencia) {
                valorDisplay.innerText = "Selecione as opções para ver o valor estimado.";
                valorHidden.value = '';
                return;
            }

            let basePrice = prices[plano.value];
            let finalPrice = 0;

            if (plano.value === 'Online') {
                if (planejamento?.value === 'Sim') {
                    finalPrice = basePrice + 100; // Exemplo de custo adicional para planejamento online
                } else {
                    finalPrice = basePrice;
                }
            } else {
                const multiplier = parseInt(frequencia) > 0 ? parseInt(frequencia) : 1;
                finalPrice = basePrice;
                if (planejamento?.value === 'Sim') {
                    finalPrice += 100;
                }
            }

            // Aplica o acréscimo da forma de pagamento
            if (formaPagamento) {
                const taxa = paymentFees[formaPagamento];
                if (formaPagamento === 'Boleto') {
                    finalPrice += taxa;
                } else {
                    finalPrice = finalPrice * (1 + taxa);
                }
            }

            if (finalPrice > 0) {
                valorDisplay.innerText = `Valor Estimado: R$ ${finalPrice.toFixed(2).replace('.', ',')}`;
                valorHidden.value = finalPrice.toFixed(2);
            } else {
                valorDisplay.innerText = "Selecione as opções para ver o valor estimado.";
                valorHidden.value = '';
            }
        }
        
        // Chamada inicial para mostrar o preço correto se já houver opções selecionadas ao carregar a página
        calculatePrice();

        // Adiciona listeners para os campos que afetam o preço
        document.querySelectorAll('input[name="Plano Escolhido"], input[name="Planejamento Alimentar"]').forEach(radio => {
            radio.addEventListener('change', calculatePrice);
        });
        document.getElementById('frequenciaSemana').addEventListener('change', calculatePrice);
        document.getElementById('formaPagamento').addEventListener('change', calculatePrice);


        function validateStep(step) {
            const currentStepDiv = steps[step - 1];
            const requiredInputs = currentStepDiv.querySelectorAll('[required]');
            let allValid = true;

            requiredInputs.forEach(input => {
                if (!input.checkValidity()) {
                    allValid = false;
                    // Adiciona uma classe de erro ou mostra uma mensagem
                    input.classList.add('border-red-500', 'ring-2', 'ring-red-500');
                    if (input.type === 'radio' && input.name) {
                        const radioGroup = document.querySelector(`input[name="${input.name}"]`).closest('.form-group');
                        let errorMessage = radioGroup.querySelector('.error-message');
                        if (!errorMessage) {
                            errorMessage = document.createElement('p');
                            errorMessage.className = 'error-message';
                            radioGroup.appendChild(errorMessage);
                        }
                        errorMessage.innerText = 'Este campo é obrigatório.';
                    }
                } else {
                    input.classList.remove('border-red-500', 'ring-2', 'ring-red-500');
                    const radioGroup = document.querySelector(`input[name="${input.name}"]`)?.closest('.form-group');
                    if (radioGroup) {
                        const errorMessage = radioGroup.querySelector('.error-message');
                        if (errorMessage) {
                            errorMessage.remove();
                        }
                    }
                }
            });

            // Lógica adicional para o plano Online
            if (step === 1) {
                const planoOnline = document.querySelector('input[name="Plano Escolhido"][value="Online"]:checked');
                const planejamentoSim = document.querySelector('input[name="Planejamento Alimentar"][value="Sim"]:checked');
                if (planoOnline && !planejamentoSim) {
                    alert('Para o plano Online, o planejamento alimentar é obrigatório.');
                    allValid = false;
                }
            }

            return allValid;
        }

        function nextStep(step) {
            if (!validateStep(step)) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }

            if (step < totalSteps) {
                steps[currentStep - 1].classList.add('hidden-group');
                currentStep++;
                if (currentStep === totalSteps) {
                    generateReview();
                }
                steps[currentStep - 1].classList.remove('hidden-group');
            }
        }
        
        function prevStep() {
            if (currentStep > 1) {
                steps[currentStep - 1].classList.add('hidden-group');
                currentStep--;
                steps[currentStep - 1].classList.remove('hidden-group');
            }
        }

        function toggleDetails(type, radio) {
            const targetDiv = document.getElementById(type + 'Detalhes');
            if (radio.value === 'Sim') {
                targetDiv.classList.remove('hidden-group');
            } else {
                targetDiv.classList.add('hidden-group');
            }
        }
        
        function generateReview() {
            const reviewContainer = document.getElementById('reviewContent');
            reviewContainer.innerHTML = '';
            
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
                // Tratar checkboxes, pois FormData agrupa apenas se houver múltiplos valores
                if (key.includes('Objetivos Musculação')) {
                    if (!data[key]) {
                        data[key] = [];
                    }
                    data[key].push(value);
                } else {
                    data[key] = value;
                }
            }

            let htmlContent = '';
            
            // Reagrupar por seção
            const sections = {
                'Informações Pessoais': ['Nome Completo', 'Data de Nascimento', 'Idade', 'Altura', 'Peso', 'Gênero', 'Profissão', 'Telefone de Contato', 'Contato de Emergência', 'CPF', 'Endereço', 'E-mail', 'Instagram', 'Data de Início', 'Plano Escolhido', 'Planejamento Alimentar', 'Frequência Semanal', 'Forma de Pagamento', 'Valor Estimado Mensal'],
                'Histórico de Aptidão Física': ['Cirurgia Últimos 12 Meses (Anaminese)', 'Qual Cirurgia e Data (Anaminese)', 'Problemas Coluna (Anaminese)', 'Qual Problema Coluna (Anaminese)', 'Problemas Articulações (Anaminese)', 'Qual Problema Articulação (Anaminese)', 'Lesão Muscular Articular (Anaminese)', 'Qual Lesão e Tratamento (Anaminese)', 'Restrição Médica (Anaminese)', 'Qual Restrição Médica (Anaminese)', 'Fuma (Anaminese)', 'Frequência Fuma (Anaminese)', 'Ingere Álcool (Anaminese)', 'Frequência Álcool (Anaminese)', 'Pratica Atividade Física (Anaminese)', 'Qual Atividade, Frequência e Tempo (Anaminese)', 'Nível Experiência Musculação (Anaminese)', 'Tempo Treinou (Anaminese)', 'Treinou Personal Trainer (Anaminese)', 'Qualidade do Sono (Anaminese)'],
                'Objetivos e Expectativas': ['Objetivos Musculação (Anaminese)', 'Especificar Reabilitação (Anaminese)', 'Resultado e Expectativa (Anaminese)', 'Outras Informações (Anaminese)'],
                'Formulário Nutricional': ['Medicação Contínua (Nutricional)', 'Qual Medicação (Nutricional)', 'Doença Crônica (Nutricional)', 'Qual Doença Crônica (Nutricional)', 'Intolerância Alimentar (Nutricional)', 'Qual Intolerância Alimentar (Nutricional)', 'Uso de Suplementos (Nutricional)', 'Qual Suplementos (Nutricional)', 'Qualidade do Sono (Nutricional)', 'Horário que Acorda (Nutricional)', 'Horário que Dorme (Nutricional)', 'Bebe Café (Nutricional)', 'Qual Café (Nutricional)', 'Quantidade Água (Nutricional)', 'Ingredientes que Não Gosta (Nutricional)', 'Melhor Horário para Treino (Nutricional)', 'Refeição Pré-Treino (Nutricional)', 'Refeição Pós-Treino (Nutricional)', 'Refeições por Dia (Nutricional)', 'Café da Manhã (Nutricional)', 'Almoço (Nutricional)', 'Lanche da Tarde (Nutricional)', 'Jantar (Nutricional)']
            };

            for (const sectionTitle in sections) {
                htmlContent += `<h3 class="section-title">${sectionTitle}</h3>`;
                sections[sectionTitle].forEach(key => {
                    let value = data[key] || '';
                    if (value && typeof value === 'object') {
                        value = value.join(', ');
                    }
                    if (value) {
                        const formattedKey = key.replace(/\(Anaminese\)|\(Nutricional\)|\(kg\)|\(cm\)|\/s/g, '').trim();
                        htmlContent += `<p><strong>${formattedKey}:</strong> ${value}</p>`;
                    }
                });
            }

            reviewContainer.innerHTML = htmlContent;
        }
    </script>
</body>
</html>
